services:
  lidarr:
    container_name: lidarr
    image: linuxserver/lidarr:latest
    networks:
      - arr-stack
    ports:
      - 8686:8686/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Music/Regular Music:/data/music
      - ${DOWNLOADS}/completed/music:/data/downloads
      - ${DOWNLOADS}/../soulseek:/data/soulseek
      - ${APPDATA}/lidarr:/config
      - ${APPDATA}/lidarr/custom-services.d:/custom-services.d
      - ${APPDATA}/lidarr/custom-cont-init.d:/custom-cont-init.d
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  xmas-lidarr:
    container_name: xmas-lidarr
    image: linuxserver/lidarr:latest
    networks:
      - arr-stack
    ports:
      - 8585:8686/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Music/Christmas Music:/data/music
      - ${DOWNLOADS}/completed/music:/data/downloads
      - ${APPDATA}/xmaslidarr:/config
      - ${APPDATA}/lidarr/custom-services.d:/custom-services.d
      - ${APPDATA}/lidarr/custom-cont-init.d:/custom-cont-init.d
      - ${DOWNLOADS}/../soulseek:/data/soulseek
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  kpoplidarr:
    container_name: kpop-lidarr
    image: blampe/lidarr:latest
    networks:
      - arr-stack
    ports:
      - 7676:8686/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Music/K-Pop:/data/music
      - ${DOWNLOADS}/completed/music:/data/downloads
      - ${DOWNLOADS}/../soulseek:/data/soulseek
      - ${APPDATA}/kpop-lidarr:/config
      # - ${APPDATA}/largelidarr/custom-services.d:/custom-services.d
      # - ${APPDATA}/largelidarr/custom-cont-init.d:/custom-cont-init.d
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  headphones:
    image: lscr.io/linuxserver/headphones:latest
    container_name: headphones
    networks:
      - arr-stack
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${APPDATA}/headphones:/config
      - ${DOWNLOADS}/../soulseek:/downloads
      - ${DATA}/Music/Regular Music:/music
    ports:
      - 8787:8787
    restart: unless-stopped

  radarr:
    container_name: radarr
    image: lscr.io/linuxserver/radarr:latest
    networks:
      - arr-stack
    ports:
      - 7878:7878/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Movies:/data/movies
      # - ${DATA}/Movies/Hammar Horror:/data/horror
      - ${DOWNLOADS}/completed/other:/data/downloads
      - ${APPDATA}/radarr:/config
      # - radarr-data:/other
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  radarr4k:
    container_name: radarr4k
    image: lscr.io/linuxserver/radarr:latest
    networks:
      - arr-stack
    ports:
      - 4444:7878/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Movies/4K Movies:/data/movies
      - ${DOWNLOADS}/completed/4K:/data/downloads
      - ${APPDATA}/radarr4k:/config
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  sonarr:
    container_name: sonarr
    image: linuxserver/sonarr:latest
    networks:
      - arr-stack
    ports:
      - 8989:8989/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Shows:/data/shows
      # - ${DATA}/Cartoons:/cartoons
      - ${DOWNLOADS}/completed/other:/data/downloads
      - ${APPDATA}/sonarr:/config
      - ${APPDATA}/sonarr/custom-services.d:/custom-services.d
      - ${APPDATA}/sonarr/custom-cont-init.d:/custom-cont-init.d
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  sonarr4k:
    container_name: sonarr4k
    image: linuxserver/sonarr:latest
    networks:
      - arr-stack
    ports:
      - 8484:8989/tcp
    restart: unless-stopped
    volumes:
      - ${RECYCLE}:/data/recycle
      - ${DATA}/Shows:/data/shows
      # - ${DATA}/4K Cartoons:/cartoons
      - ${DOWNLOADS}/completed/4K:/data/downloads
      - ${APPDATA}/sonarr4k:/config
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}

  # readarr:
  #   image: lscr.io/linuxserver/readarr:develop
  #   container_name: readarr
  #   networks: 
  #     - arr-stack
  #   environment:
  #     - PUID=${PUID}
  #     - PGID=${PGID}
  #     - TZ=${TZ}
  #   volumes:
  #     - ${APPDATA}/readarr:/config
  #     - ${DATA}/eBooks:/books
  #     - ${DOWNLOADS}/completed/books:/downloads
  #     - ${RECYCLE}:/recycle
  #   ports:
  #     - 8787:8787
  #   restart: unless-stopped

  lazylibrarian:
    image: lscr.io/linuxserver/lazylibrarian:latest
    container_name: lazylibrarian
    networks:
      - arr-stack
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - DOCKER_MODS=linuxserver/mods:universal-calibre|linuxserver/mods:lazylibrarian-ffmpeg #optional
    volumes:
      - ${APPDATA}/lazy-librarian:/config
      - ${DOWNLOADS}/completed/books:/data/downloads
      - ${DATA}/Books:/data/books
    ports:
      - 5299:5299
    restart: unless-stopped

  calibre-web:
    image: lscr.io/linuxserver/calibre-web:latest
    container_name: calibre-web
    networks:
      - arr-stack
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
      - DOCKER_MODS=linuxserver/mods:universal-calibre #optional
      - OAUTHLIB_RELAX_TOKEN_SCOPE=1 #optional
    volumes:
      - ${APPDATA}/calibre-web:/config
      - ${DATA}/books/eBooks:/data/books
    ports:
      - 8083:8083
    restart: unless-stopped


  audiobookshelf:
    image: ghcr.io/advplyr/audiobookshelf:latest
    container_name: audiobookshelf
    networks:
      - arr-stack
    ports:
      - 13378:80
    volumes:
      - ${DATA}/Books:/data/books
      - ${APPDATA}/audiobookshelf/config:/config
      - ${APPDATA}/audiobookshelf/metadata:/metadata
    restart: unless-stopped

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:develop
    container_name: prowlarr
    # network_mode: "service:gluetun"
    networks:
      - arr-stack
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${APPDATA}/prowlarr:/config
    ports:
      - 9696:9696
    restart: unless-stopped

  flaresolverr:
    # DockerHub mirror flaresolverr/flaresolverr:latest
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    # network_mode: "service:gluetun"
    networks:
      - arr-stack
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-info}
      - LOG_HTML=${LOG_HTML:-false}
      - CAPTCHA_SOLVER=${CAPTCHA_SOLVER:-none}
      - TZ=${TZ}
    ports:
      - 8191:8191
    restart: unless-stopped

  bazarr:
    image: linuxserver/bazarr:latest
    container_name: bazarr
    networks:
      - arr-stack
    environment:
      - PUID=${PUID}
      - PGID=${PGID}
      - TZ=${TZ}
    volumes:
      - ${DATA}/Shows/Cartoons:/cartoons
      - ${DATA}/Movies/Regular Movies:/movies
      - ${DATA}/Shows/TV Shows:/tv
      - ${APPDATA}/bazarr:/config
    ports:
      - 6767:6767
    restart: unless-stopped

  huntarr:
    image: huntarr/huntarr:latest
    container_name: huntarr
    networks:
      - arr-stack
    restart: always
    ports:
      - "9705:9705"
    volumes:
      - ${APPDATA}/huntarr:/config
    environment:
      - TZ=${TZ}

  cleanuparr:
    image: ghcr.io/cleanuparr/cleanuparr:latest
    container_name: cleanuparr
    restart: unless-stopped
    ports:
      - "11011:11011"
    volumes:
      - ${APPDATA}/cleanuparr:/config
    environment:
      - PORT=11011
      - BASE_PATH=
      - PUID=${PUID}
      - PGID=${PGID}
      - UMASK=022
      - TZ=${TZ}
    # Health check configuration
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:11011/health"]
      interval: 30s        # Check every 30 seconds
      timeout: 10s         # Allow up to 10 seconds for response
      start_period: 30s    # Wait 30 seconds before first check
      retries: 3           # Mark unhealthy after 3 consecutive failures

  # gluetun:
  #   image: qmcgaw/gluetun
  #   container_name: gluetun
  #   hostname: gluetun
  #   networks:
  #     - arr-stack
  #   cap_add:
  #     - NET_ADMIN
  #   devices:
  #     - /dev/net/tun:/dev/net/tun
  #   environment:
  #     - VPN_SERVICE_PROVIDER=nordvpn
  #     - VPN_TYPE=openvpn # or wireguard
  #     - OPENVPN_USER=ANjcTRAkd2sx5tRbssYzFcuH
  #     - OPENVPN_PASSWORD=QhTZa4VLtswTHNb262GD93ie
  #     - SERVER_COUNTRIES=Netherlands
  #     - TZ=${TZ}
  #   # ports:
  #   #   - 9696:9696 # prowlarr
  #   #   - 8191:8191 # flaresolverr

# volumes:
#   radarr-data:
#     driver_opts:
#       type: "nfs"
#       o: "addr=10.0.0.2,nolock,soft,rw,nfsvers=4"
#       device: ":tardis/Data/"

networks:
  arr-stack:
